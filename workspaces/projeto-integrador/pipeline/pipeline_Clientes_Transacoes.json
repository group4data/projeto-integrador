{
	"name": "pipeline_Clientes_Transacoes",
	"properties": {
		"activities": [
			{
				"name": "view all_transactions",
				"description": "",
				"type": "Script",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "Group4Data_Database",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "CREATE VIEW all_transactions AS \n  SELECT * FROM ( \n    SELECT id, client_id, value, date_time, 'in' AS transaction_type FROM transactions_in\n    UNION ALL\n    SELECT id, client_id, value, date_time, 'out' AS transaction_type FROM transactions_out) AS transactions;"
						}
					],
					"scriptBlockExecutionTimeout": "02:00:00"
				}
			},
			{
				"name": "view fraudulent_transactions",
				"description": "",
				"type": "Script",
				"dependsOn": [
					{
						"activity": "view all_transactions",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "Group4Data_Database",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "CREATE VIEW fraudulent_transactions AS \n  SELECT * FROM (\n  SELECT client_id, table_datatime_previous.id AS id_transaction, value, date_time, transaction_type\n    FROM (\n      SELECT id, client_id, value, date_time, transaction_type,\n        LAG(date_time) OVER (\n          PARTITION BY client_id\n          ORDER BY date_time\n        ) AS datatime_previous\n      FROM all_transactions\n    ) AS table_datatime_previous\n    JOIN clients ON table_datatime_previous.client_id = clients.id\n    WHERE datediff(SECOND, datatime_previous, date_time) < 120\n    ) AS frauds"
						}
					],
					"scriptBlockExecutionTimeout": "02:00:00"
				}
			},
			{
				"name": "view frauds_by_state",
				"description": "",
				"type": "Script",
				"dependsOn": [
					{
						"activity": "view frauds_by_client",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "Group4Data_Database",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "CREATE VIEW frauds_by_state AS\n    SELECT c.state, COUNT(ft.client_id) as qty_of_frauds\n    FROM fraudulent_transactions ft \n    JOIN clients c \n    ON c.id = ft.client_id \n    GROUP BY c.state;"
						}
					],
					"scriptBlockExecutionTimeout": "02:00:00"
				}
			},
			{
				"name": "view sum_of_frauds",
				"description": "",
				"type": "Script",
				"dependsOn": [
					{
						"activity": "Order by qty_of_frauds desc",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "Group4Data_Database",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "CREATE VIEW sum_of_frauds AS\n    SELECT transaction_type, SUM(value) as sum_value\n    FROM  fraudulent_transactions\n    GROUP BY transaction_type;"
						}
					],
					"scriptBlockExecutionTimeout": "02:00:00"
				}
			},
			{
				"name": "view count_of_frauds",
				"description": "",
				"type": "Script",
				"dependsOn": [
					{
						"activity": "Order by sum_value desc",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "Group4Data_Database",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "CREATE VIEW count_of_frauds AS\n    SELECT transaction_type, COUNT(value) as qty_of_transactions\n    FROM  fraudulent_transactions\n    GROUP BY transaction_type;"
						}
					],
					"scriptBlockExecutionTimeout": "02:00:00"
				}
			},
			{
				"name": "view frauds_by_year",
				"description": "",
				"type": "Script",
				"dependsOn": [
					{
						"activity": "Order by qty_of_transactions desc 2",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "Group4Data_Database",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "CREATE VIEW frauds_by_year AS\n    SELECT YEAR(date_time) AS Year, COUNT(*) AS frauds_by_year\n    FROM fraudulent_transactions\n    GROUP BY YEAR(date_time);"
						}
					],
					"scriptBlockExecutionTimeout": "02:00:00"
				}
			},
			{
				"name": "view frauds_by_shift_and_year",
				"description": "",
				"type": "Script",
				"dependsOn": [
					{
						"activity": "Order by Year desc",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "Group4Data_Database",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "CREATE VIEW frauds_by_shift_and_year AS\n    SELECT DATEPART(year, date_time) AS Year, \n        CASE \n            WHEN DATEPART(hour, date_time) BETWEEN 0 AND 5 THEN '0-6 hours'\n            WHEN DATEPART(hour, date_time) BETWEEN 6 AND 11 THEN '6-12 hours'\n            WHEN DATEPART(hour, date_time) BETWEEN 12 AND 17 THEN '12-18 hours'\n            WHEN DATEPART(hour, date_time) BETWEEN 18 AND 23 THEN '18-24 hours'\n        END AS transaction_time,\n        COUNT(*) AS qty_of_transactions\n    FROM fraudulent_transactions\n    GROUP BY DATEPART(year, date_time), \n            CASE \n                WHEN DATEPART(hour, date_time) BETWEEN 0 AND 5 THEN '0-6 hours'\n                WHEN DATEPART(hour, date_time) BETWEEN 6 AND 11 THEN '6-12 hours'\n                WHEN DATEPART(hour, date_time) BETWEEN 12 AND 17 THEN '12-18 hours'\n                WHEN DATEPART(hour, date_time) BETWEEN 18 AND 23 THEN '18-24 hours'\n            END;"
						}
					],
					"scriptBlockExecutionTimeout": "02:00:00"
				}
			},
			{
				"name": "view frauds_by_month",
				"description": "",
				"type": "Script",
				"dependsOn": [
					{
						"activity": "Order by Year",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "Group4Data_Database",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "CREATE VIEW frauds_by_month AS\n    SELECT MONTH(date_time) AS month, COUNT(id_transaction) AS qty_of_frauds\n    FROM fraudulent_transactions\n    GROUP BY MONTH(date_time);"
						}
					],
					"scriptBlockExecutionTimeout": "02:00:00"
				}
			},
			{
				"name": "view frauds_by_client",
				"description": "",
				"type": "Script",
				"dependsOn": [
					{
						"activity": "order by client_id - out",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "order by client_id - in",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "Group4Data_Database",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "CREATE VIEW frauds_by_client AS\n    SELECT c.name, c.id, COUNT(ft.id_transaction) as qty_of_transactions, SUM(value) as value_total_frauds\n    FROM  fraudulent_transactions ft\n    JOIN  clients c\n    ON c.id = ft.client_id \n    GROUP BY ft.client_id, c.name, c.id;"
						}
					],
					"scriptBlockExecutionTimeout": "02:00:00"
				}
			},
			{
				"name": "Order by qty_of_frauds desc",
				"description": "",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "view frauds_by_state",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"sqlReaderQuery": "SELECT * \nFROM frauds_by_state\nORDER BY qty_of_frauds DESC;",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "frauds_by_state",
						"type": "DatasetReference"
					},
					"firstRowOnly": false
				}
			},
			{
				"name": "Order by sum_value desc",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "view sum_of_frauds",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"sqlReaderQuery": "SELECT * \nFROM sum_of_frauds\nORDER BY sum_value DESC;",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "sum_of_frauds",
						"type": "DatasetReference"
					},
					"firstRowOnly": false
				}
			},
			{
				"name": "Order by qty_of_transactions desc 2",
				"description": "",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "view count_of_frauds",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"sqlReaderQuery": "SELECT * \nFROM count_of_frauds\nORDER BY qty_of_transactions DESC;",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "count_of_frauds",
						"type": "DatasetReference"
					},
					"firstRowOnly": false
				}
			},
			{
				"name": "Order by Year desc",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "view frauds_by_year",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"sqlReaderQuery": "SELECT * \nFROM frauds_by_year\nORDER BY Year DESC;",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "frauds_by_year",
						"type": "DatasetReference"
					},
					"firstRowOnly": false
				}
			},
			{
				"name": "Order by Year",
				"description": "",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "view frauds_by_shift_and_year",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"sqlReaderQuery": "SELECT * \nFROM frauds_by_shift_and_year\nORDER BY Year;",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "frauds_by_shift_and_year",
						"type": "DatasetReference"
					},
					"firstRowOnly": false
				}
			},
			{
				"name": "Order by qty_of_frauds desc 2",
				"description": "",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "view frauds_by_month",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"sqlReaderQuery": "SELECT * \nFROM frauds_by_month\nORDER BY qty_of_frauds DESC;",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "frauds_by_month",
						"type": "DatasetReference"
					},
					"firstRowOnly": false
				}
			},
			{
				"name": "all_transactions_csv",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "view all_transactions",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "all_transactions",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "allTransactions",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "fraudulent_transactions_csv",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "view fraudulent_transactions",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "fraudulent_transactions",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "fraudulentTransactions",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "frauds_by_client_csv",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "view frauds_by_client",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "frauds_by_client",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "fraudsByClient",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "frauds_by_state_csv",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "view frauds_by_state",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "frauds_by_state",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "fraudsByState",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "sum_of_frauds_csv",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "view sum_of_frauds",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "sum_of_frauds",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "sumOfFrauds",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "count_of_frauds_csv",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "view count_of_frauds",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "count_of_frauds",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "countOfFrauds",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "frauds_by_year_csv",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "view frauds_by_year",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "frauds_by_year",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "fraudsByYear",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "frauds_by_shift_and_year_csv",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "view frauds_by_shift_and_year",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "frauds_by_shift_and_year",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "fraudsByShiftAndYear",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "frauds_by_month_csv",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "view frauds_by_month",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "frauds_by_month",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "fraudsByMonth",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "drop all views",
				"type": "Script",
				"dependsOn": [
					{
						"activity": "frauds_by_month_csv",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "Group4Data_Database",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "DROP VIEW all_transactions;\nDROP VIEW fraudulent_transactions;\nDROP VIEW frauds_transactions_out;\nDROP VIEW frauds_transactions_in;\nDROP VIEW frauds_by_client;\nDROP VIEW frauds_by_state;\nDROP VIEW sum_of_frauds;\nDROP VIEW count_of_frauds;\nDROP VIEW frauds_by_year;\nDROP VIEW view frauds_by_shift_and_year;\nDROP VIEW frauds_by_month;"
						}
					],
					"scriptBlockExecutionTimeout": "02:00:00"
				}
			},
			{
				"name": "table frauds_transactions_out ",
				"type": "Script",
				"dependsOn": [
					{
						"activity": "view fraudulent_transactions",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "table frauds_transactions_in",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "Group4Data_Database",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "SELECT *\nINTO frauds_transactions_out \nFROM fraudulent_transactions\nWHERE transaction_type = 'out';"
						}
					],
					"scriptBlockExecutionTimeout": "02:00:00"
				}
			},
			{
				"name": "frauds_transactions_out_csv",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "table frauds_transactions_out ",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "frauds_transactions_out",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "fraudsTransactionsOut",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "table frauds_transactions_in",
				"type": "Script",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "Group4Data_Database",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "SELECT *\nINTO frauds_transactions_in \nFROM fraudulent_transactions\nWHERE transaction_type = 'in';"
						}
					],
					"scriptBlockExecutionTimeout": "02:00:00"
				}
			},
			{
				"name": "frauds_transactions_in_csv",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "table frauds_transactions_in",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "frauds_transactions_in",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "fraudsTransactionsIn",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "alter table in 1",
				"type": "Script",
				"dependsOn": [
					{
						"activity": "table frauds_transactions_in",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "Group4Data_Database",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "ALTER TABLE frauds_transactions_in\nADD CONSTRAINT fk_clients_id\nFOREIGN KEY (client_id)\nREFERENCES clients (id);"
						}
					],
					"scriptBlockExecutionTimeout": "02:00:00"
				}
			},
			{
				"name": "alter table in 2",
				"type": "Script",
				"dependsOn": [
					{
						"activity": "alter table in 1",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "Group4Data_Database",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "ALTER TABLE frauds_transactions_in\nADD CONSTRAINT fk_transactions_id_in\nFOREIGN KEY (id_transaction)\nREFERENCES transactions_in (id);"
						}
					],
					"scriptBlockExecutionTimeout": "02:00:00"
				}
			},
			{
				"name": "alter table out 2",
				"type": "Script",
				"dependsOn": [
					{
						"activity": "alter table out 1",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "Group4Data_Database",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "ALTER TABLE frauds_transactions_out\nADD CONSTRAINT fk_transactions_id_out\nFOREIGN KEY (id_transaction)\nREFERENCES transactions_out (id);"
						}
					],
					"scriptBlockExecutionTimeout": "02:00:00"
				}
			},
			{
				"name": "alter table out 1",
				"type": "Script",
				"dependsOn": [
					{
						"activity": "table frauds_transactions_out ",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "Group4Data_Database",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "ALTER TABLE frauds_transactions_out\nADD CONSTRAINT fk_clients_id_out\nFOREIGN KEY (client_id)\nREFERENCES clients (id);"
						}
					],
					"scriptBlockExecutionTimeout": "02:00:00"
				}
			},
			{
				"name": "order by client_id - out",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "alter table out 2",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"sqlReaderQuery": "SELECT * FROM frauds_transactions_out ORDER BY client_id;",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "frauds_transactions_out",
						"type": "DatasetReference"
					}
				}
			},
			{
				"name": "order by client_id - in",
				"description": "SELECT * FROM frauds_transactions_in ORDER BY client_id;",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "alter table in 2",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "frauds_transactions_in",
						"type": "DatasetReference"
					}
				}
			},
			{
				"name": "order by qty_of_transactions desc",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "view frauds_by_client",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"sqlReaderQuery": "SELECT * \nFROM frauds_by_client\nORDER BY qty_of_transactions DESC;",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "frauds_by_client",
						"type": "DatasetReference"
					}
				}
			},
			{
				"name": "order by value_total_frauds desc",
				"type": "Lookup",
				"dependsOn": [
					{
						"activity": "view frauds_by_client",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"sqlReaderQuery": "SELECT * \nFROM frauds_by_client \nORDER BY value_total_frauds DESC;",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"dataset": {
						"referenceName": "frauds_by_client",
						"type": "DatasetReference"
					}
				}
			}
		],
		"annotations": []
	}
}